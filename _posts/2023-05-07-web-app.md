---
layout: single
title:  "web-appêµ¬í˜„í•˜ê¸°"
categories: coding
tag: [python, blog, jekyll]
toc: true
author_profile: false
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }

    table.dataframe td {
      text-align: center;
      padding: 8px;
    }

    table.dataframe tr:hover {
      background: #b8d1f3; 
    }

    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>


#UFO sighting ì— ê´€í•œ ë¡œì§€ìŠ¤í‹± íšŒê·€ ëª¨ë¸ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì›¹ì•± ë§Œë“¤ê¸°


# ë°ì´í„° ì •ì œ


1. pandas, matplotlib, numpyë¥¼ ê°€ì ¸ì™€ì„œ ufos ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ìƒ˜í”Œ ë°ì´í„° ì§‘í•©ì„ ì‚´í´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:



```python
import pandas as pd
import numpy as np
ufos = pd.read_csv('https://raw.githubusercontent.com/JOJeongHaeng/jeonghaeng.github.io/main/ufos.csv')
ufos.head()
```

<pre>
           datetime                  city state country     shape  \
0  10/10/1949 20:30            san marcos    tx      us  cylinder   
1  10/10/1949 21:00          lackland afb    tx     NaN     light   
2  10/10/1955 17:00  chester (uk/england)   NaN      gb    circle   
3  10/10/1956 21:00                  edna    tx      us    circle   
4  10/10/1960 20:00               kaneohe    hi      us     light   

   duration (seconds) duration (hours/min)  \
0              2700.0           45 minutes   
1              7200.0              1-2 hrs   
2                20.0           20 seconds   
3                20.0             1/2 hour   
4               900.0           15 minutes   

                                            comments date posted   latitude  \
0  This event took place in early fall around 194...   4/27/2004  29.883056   
1  1949 Lackland AFB&#44 TX.  Lights racing acros...  12/16/2005  29.384210   
2  Green/Orange circular disc over Chester&#44 En...   1/21/2008  53.200000   
3  My older brother and twin sister were leaving ...   1/17/2004  28.978333   
4  AS a Marine 1st Lt. flying an FJ4B fighter/att...   1/22/2004  21.418056   

    longitude  
0  -97.941111  
1  -98.581082  
2   -2.916667  
3  -96.645833  
4 -157.803611  
</pre>
2. ufos ë°ì´í„°ë¥¼ ìƒˆë¡œìš´ ì œëª©ì„ ê°€ì§„ ì‘ì€ ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. êµ­ê°€ í•„ë“œì—ì„œ ê³ ìœ  ê°’ì„ í™•ì¸í•©ë‹ˆë‹¤.



```python
ufos = pd.DataFrame({'Seconds': ufos['duration (seconds)'], 'Country': ufos['country'],'Latitude': ufos['latitude'],'Longitude': ufos['longitude']})

ufos.Country.unique()
```

<pre>
array(['us', nan, 'gb', 'ca', 'au', 'de'], dtype=object)
</pre>
ì´ì œ null ê°’ì„ ì‚­ì œí•˜ê³  1~60ì´ˆ ì‚¬ì´ì˜ ëª©ê²© íšŸìˆ˜ë§Œ ê°€ì ¸ì™€ì„œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ë°ì´í„°ì˜ ì–‘ì„ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:



```python
ufos.dropna(inplace=True)

ufos = ufos[(ufos['Seconds'] >= 1) & (ufos['Seconds'] <= 60)]

ufos.info()
```

<pre>
<class 'pandas.core.frame.DataFrame'>
Int64Index: 25863 entries, 2 to 80330
Data columns (total 4 columns):
 #   Column     Non-Null Count  Dtype  
---  ------     --------------  -----  
 0   Seconds    25863 non-null  float64
 1   Country    25863 non-null  object 
 2   Latitude   25863 non-null  float64
 3   Longitude  25863 non-null  float64
dtypes: float64(3), object(1)
memory usage: 1010.3+ KB
</pre>
Scikit-learnì˜ LabelEncoder ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°€ì ¸ì™€ì„œ êµ­ê°€ë³„ í…ìŠ¤íŠ¸ ê°’ì„ ìˆ«ìë¡œ ë³€í™˜í•©ë‹ˆë‹¤:



ë¼ë²¨ì¸ì½”ë”ëŠ” ë°ì´í„°ë¥¼ ì•ŒíŒŒë²³ìˆœìœ¼ë¡œ ì¸ì½”ë”©í•©ë‹ˆë‹¤.



```python
from sklearn.preprocessing import LabelEncoder

ufos['Country'] = LabelEncoder().fit_transform(ufos['Country'])

ufos.head()
```

<pre>
    Seconds  Country   Latitude   Longitude
2      20.0        3  53.200000   -2.916667
3      20.0        4  28.978333  -96.645833
14     30.0        4  35.823889  -80.253611
23     60.0        4  45.582778 -122.352222
24      3.0        3  51.783333   -0.783333
</pre>
#ëª¨ë¸ êµ¬ì¶•


ì´ì œ ë°ì´í„°ë¥¼ í•™ìŠµ ê·¸ë£¹ê³¼ í…ŒìŠ¤íŠ¸ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ëª¨ë¸ í•™ìŠµì„ ì¤€ë¹„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


1. í›ˆë ¨í•˜ë ¤ëŠ” ì„¸ ê°€ì§€ ê¸°ëŠ¥ì„ X ë²¡í„°ë¡œ ì„ íƒí•˜ê³ , Y ë²¡í„°ëŠ” êµ­ê°€ê°€ ë©ë‹ˆë‹¤. ì´ˆ, ìœ„ë„ ë° ê²½ë„ë¥¼ ì…ë ¥í•˜ê³  ë°˜í™˜í•  êµ­ê°€ IDë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆê¸°ë¥¼ ì›í•©ë‹ˆë‹¤.



```python
from sklearn.model_selection import train_test_split

Selected_features = ['Seconds','Latitude','Longitude']

X = ufos[Selected_features]
y = ufos['Country']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)
```

2. ë¡œì§€ìŠ¤í‹± íšŒê·€ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•©ë‹ˆë‹¤:



```python
from sklearn.metrics import accuracy_score, classification_report
from sklearn.linear_model import LogisticRegression
model = LogisticRegression()
model.fit(X_train, y_train)
predictions = model.predict(X_test)

print(classification_report(y_test, predictions))
print('Predicted labels: ', predictions)
print('Accuracy: ', accuracy_score(y_test, predictions))
```

<pre>
              precision    recall  f1-score   support

           0       1.00      1.00      1.00        41
           1       0.83      0.24      0.37       250
           2       1.00      1.00      1.00         8
           3       1.00      1.00      1.00       131
           4       0.96      1.00      0.98      4743

    accuracy                           0.96      5173
   macro avg       0.96      0.85      0.87      5173
weighted avg       0.96      0.96      0.95      5173

Predicted labels:  [4 4 4 ... 3 4 4]
Accuracy:  0.9607577807848444
</pre>
<pre>
/usr/local/lib/python3.10/dist-packages/sklearn/linear_model/_logistic.py:458: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</pre>
êµ­ê°€ì™€ ìœ„ë„/ê²½ë„ê°€ ìƒê´€ê´€ê³„ê°€ ìˆê¸° ë•Œë¬¸ì— ì •í™•ë„ëŠ” ë‹¹ì—°íˆ ë‚˜ì˜ì§€ ì•ŠìŠµë‹ˆë‹¤(ì•½ 95%).



ìœ„ë„ì™€ ê²½ë„ë¥¼ í†µí•´ êµ­ê°€ë¥¼ ìœ ì¶”í•  ìˆ˜ ìˆì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë§Œë“  ëª¨ë¸ì´ ê·¸ë‹¤ì§€ í˜ì‹ ì ì´ì§€ëŠ” ì•Šì§€ë§Œ, ì •ë¦¬í•˜ê³  ë‚´ë³´ë‚¸ ì›ì‹œ ë°ì´í„°ë¡œ í•™ìŠµí•œ ë‹¤ìŒ ì›¹ ì•±ì—ì„œ ì´ ëª¨ë¸ì„ ì‚¬ìš©í•´ ë³´ëŠ” ê²ƒì€ ì¢‹ì€ ì—°ìŠµì´ ë©ë‹ˆë‹¤.


#ëª¨ë¸ 'í”¼í´'


ì´ì œ ëª¨ë¸ì„ í”¼í´í•  ì‹œê°„ì…ë‹ˆë‹¤! ëª‡ ì¤„ì˜ ì½”ë“œë¡œ ì´ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”¼í´ì´ ì™„ë£Œë˜ë©´ í”¼í´ëœ ëª¨ë¸ì„ ë¡œë“œí•˜ê³  ì´ˆ, ìœ„ë„ ë° ê²½ë„ ê°’ì´ í¬í•¨ëœ ìƒ˜í”Œ ë°ì´í„° ë°°ì—´ì— ëŒ€í•´ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤,



```python
import pickle
model_filename = 'ufo-model.pkl'
pickle.dump(model, open(model_filename,'wb'))

model = pickle.load(open('/content/ufo-model.pkl','rb'))
print(model.predict([[50,44,-12]]))
```

<pre>
[1]
</pre>
<pre>
/usr/local/lib/python3.10/dist-packages/sklearn/base.py:439: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  warnings.warn(
</pre>
## ì—°ìŠµ - Flask ì•± ë§Œë“¤ê¸°



ì§€ê¸ˆë¶€í„° Flask ì•±ì„ ë§Œë“¤ì–´ì„œ ëª¨ë¸ì„ ë¶€ë¥´ê³  ë¹„ìŠ·í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ì§€ë§Œ, ì‹œê°ì ìœ¼ë¡œ ë§Œì¡±í•  ë°©ì‹ìœ¼ë¡œë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.



1. Cë“œë¼ì´ë¸Œì— pytion_my_projectsí´ë”ë¥¼ ë§Œë“  í›„ ì•ˆì— ê°€ìƒ ê³µê°„ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤. ê·¸ í›„ í´ë”ì—ì„œ 3ê°€ì§€ í´ë”ë¥¼ ë§Œë“­ë‹ˆë‹¤: **static**, ë‚´ë¶€ì— **css** í´ë”ê°€ ìˆìœ¼ë©°, **templates`** ë„ ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ íŒŒì¼ê³¼ ë””ë ‰í† ë¦¬ë“¤ì´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤:



    ```output

    web-app/

      static/

        css/

        templates/

    notebook.ipynb

    ufo-model.pkl

    ``` 





1. ê°€ìƒê³µê°„ í´ë”ì—ì„œ ë§Œë“¤ ì²« íŒŒì¼ì€ **requirements.txt** íŒŒì¼ì…ë‹ˆë‹¤. JavaScript ì•±ì˜ _package.json_ ì²˜ëŸ¼, ì•±ì— í•„ìš”í•œ ì˜ì¡´ì„±ì„ ë¦¬ìŠ¤íŠ¸í•œ íŒŒì¼ì…ë‹ˆë‹¤. **requirements.txt** ì— í•´ë‹¹ ë¼ì¸ì„ ì¶”ê°€í•©ë‹ˆë‹¤:



    ```text

    scikit-learn

    pandas

    numpy

    flask

    ```



![image](https://user-images.githubusercontent.com/118785061/236636445-a4869106-f5f5-45af-94c5-40dd7a38ffee.png)

```pip install -r requirements.txt```

ëª…ë ¹ì–´í”„ë¡¬í”„íŠ¸ì— ìœ„ ì½”ë“œë¥¼ íƒ€ì´í•‘í•©ë‹ˆë‹¤.





1. ì§€ê¸ˆë¶€í„°, ì•±ì„ ì™„ì„±í•˜ê¸° ìœ„í•´ì„œ 3ê°€ì§€ íŒŒì¼ì„ ë” ë§Œë“¤ ì¤€ë¹„ë¥¼ í–ˆìŠµë‹ˆë‹¤:



    1. ìµœìƒë‹¨ì—  **app.py**ë¥¼ ë§Œë“­ë‹ˆë‹¤.

    2. _templates_ ë””ë ‰í† ë¦¬ì— **index.html**ì„ ë§Œë“­ë‹ˆë‹¤.

    3. _static/css_ ë””ë ‰í† ë¦¬ì— **styles.css**ë¥¼ ë§Œë“­ë‹ˆë‹¤.



1. ëª‡ ìŠ¤íƒ€ì¼ë¡œ _styles.css_ íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤:



    ```css

    body {

    	width: 100%;

    	height: 100%;

    	font-family: 'Helvetica';

    	background: black;

    	color: #fff;

    	text-align: center;

    	letter-spacing: 1.4px;

    	font-size: 30px;

    }

    

    input {

    	min-width: 150px;

    }

    

    .grid {

    	width: 300px;

    	border: 1px solid #2d2d2d;

    	display: grid;

    	justify-content: center;

    	margin: 20px auto;

    }

    

    .box {

    	color: #fff;

    	background: #2d2d2d;

    	padding: 12px;

    	display: inline-block;

    }

    ```



1. ë‹¤ìŒìœ¼ë¡œ _index.html_ íŒŒì¼ì„ ë§Œë“­ë‹ˆë‹¤:



    ```html

    <!DOCTYPE html>

    <html>

    <head>

      <meta charset="UTF-8">

      <title>ğŸ›¸ UFO Appearance Prediction! ğŸ‘½</title>

      <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"> 

    </head>

    

    <body>

     <div class="grid">

    

      <div class="box">

    

      <p>According to the number of seconds, latitude and longitude, which country is likely to have reported seeing a UFO?</p>

    

        <form action="{{ url_for('predict')}}" method="post">

        	<input type="number" name="seconds" placeholder="Seconds" required="required" min="0" max="60" />

          <input type="text" name="latitude" placeholder="Latitude" required="required" />

    		  <input type="text" name="longitude" placeholder="Longitude" required="required" />

          <button type="submit" class="btn">Predict country where the UFO is seen</button>

        </form>

    



1. `app.py` ì— ì¶”ê°€í•©ë‹ˆë‹¤:



    ```python

    import numpy as np

    from flask import Flask, request, render_template

    import pickle

    

    app = Flask(__name__)

    

    model = pickle.load(open("./ufo-model.pkl", "rb"))

    

    

    @app.route("/")

    def home():

        return render_template("index.html")

    

    

    @app.route("/predict", methods=["POST"])

    def predict():

    

        int_features = [int(x) for x in request.form.values()]

        final_features = [np.array(int_features)]

        prediction = model.predict(final_features)

    

        output = prediction[0]

    

        countries = ["Australia", "Canada", "Germany", "UK", "US"]

    

        return render_template(

            "index.html", prediction_text="Likely country: {}".format(countries[output])

        )

    

    

    if __name__ == "__main__":

        app.run(debug=True)

    ```


ëª…ë ¹ì–´ í”„ë¡¬í”„íŠ¸ì—ì„œ ê°€ìƒê³µê°„ìœ¼ë¡œ ì´ë™í›„

```

flask run

```

ì„ ì…ë ¥í•˜ë©´ ì•„ë˜ ì‚¬ì§„ì²˜ëŸ¼ ì›¹ ì£¼ì†Œê°€ ëœ¬ë‹¤.


![ìŠ¤í¬ë¦°ìƒ· 2023-05-07 012135](https://user-images.githubusercontent.com/118785061/236636478-f0464d8a-bc7a-479d-aea9-3537e330ef94.png)



ì´ë¥¼ ë“¤ì–´ê°€ ë³´ë©´


![ìŠ¤í¬ë¦°ìƒ· 2023-05-07 012234](https://user-images.githubusercontent.com/118785061/236636499-3bdbdf34-e112-4512-930e-9ad1105f5064.png)
ì´ì™€ ê°™ì€ ì›¹ì•±ì„ êµ¬í˜„ í•  ìˆ˜ ìˆë‹¤.

